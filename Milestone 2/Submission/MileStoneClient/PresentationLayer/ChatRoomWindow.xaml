<Window x:Class="MileStoneClient.PresentationLayer.ChatRoomWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:controls="clr-namespace:MileStoneClient.PresentationLayer.Controls"
        xmlns:converters="clr-namespace:MileStoneClient.PresentationLayer.Converters"
        xmlns:local="clr-namespace:MileStoneClient.PresentationLayer"
        xmlns:logic="clr-namespace:MileStoneClient.LogicLayer"
        mc:Ignorable="d"
        Title="ChatRoom - MileStone 2" Height="810" Width="965"
        ResizeMode="CanResize"
        MinHeight="810" MinWidth="965" BorderThickness="3" BorderBrush="#FF828282"
        WindowStartupLocation="CenterScreen" Closing="Window_Close" WindowState="{Binding Path=windowState, Mode=TwoWay}"
        KeyDown="Window_KeyDown" Background="#FFC2C2BE" SizeChanged="Window_SizeChanged">

    <!--Resources Decleration-->
    <Window.Resources>
        <local:GUI x:Key="GUI"/>
        <controls:BindableRichTextBox x:Key="BindableRichTextBox"/>
        <converters:AdditionSubstractionConvertor x:Key="AdditionSubstractionConvertor"/>
        <converters:InvertableBooleanToVisibilityConverter x:Key="InvertableBoolToVisibilityConverter"/>
        <converters:FontSizeOffsetToRealFontSizeConverter x:Key="FontSizeOffsetToRealFontSizeConverter"/>
        <ItemsPanelTemplate x:Key="NoSideIconMenu">
            <StackPanel Margin="-35,0,-50,0" Background="White"/>
        </ItemsPanelTemplate>
    </Window.Resources>

    <Grid Name ="MainGrid">
        <Grid.RowDefinitions>
            <RowDefinition Height="17"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <!--Upper Main menu Area-->
        <DockPanel Grid.Row="0" HorizontalAlignment="Stretch"  Height="18" VerticalAlignment="Top" Margin="0,-1,-2,0" Background="#FF616161">
            <Grid Name ="MenuGrid" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0,0,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="350"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Menu Grid.Column="0" DockPanel.Dock="Top" Height="18" VerticalAlignment="Top" Background="#FF616161" Foreground="Black" BorderBrush="Black" Margin="0,0,0,0">
                    <MenuItem Header="_File"  Width="65" Background="#FFA4A1A1">
                        <MenuItem Name="Maximize_Minimize_menu" Header="Maximize\Normal window" Click="Maximize_Minimize_Window" Foreground="Black">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/resize_window.png" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem Name="SoundStatus_Menu" Header="Turn Sounds Off" Click="Sound_OnOff" Foreground="Black">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/sound_off.png" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem  Header="_Logout" Click="Logout_Message" Foreground="Black">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/logout_menu_choice.ico" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem  Header="_Exit" Click="Exit_Button" Foreground="Black">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/exit_menu_choice.ico" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                    </MenuItem>
                    <MenuItem Header="Messages" Width="77" Background="#FFA4A1A1">
                        <MenuItem  Header="_Send" Click="SendMessage_Button" Foreground="Black">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/send_menu_choice.ico" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem  Header="_Add Emoticon"  Click="Open_Emoticon_Context_Menu" Foreground="Black">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/emoticon_menu_icon.ico" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem  Header="_Font size +" Tag="+" Click="Change_Font_Size" Foreground="Black">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/font_size_larger_menu_icon.png" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem  Header="_Font size -" Tag="-" Click="Change_Font_Size" Foreground="Black">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/font_size_smaller_menu_icon.png" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem  Header="_Default font size" Tag="default" Click="Change_Font_Size" Foreground="Black">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/default_settings_icon.png" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem  Header="_Change message view" Tag="default" Click="Change_Message_View_Type" Foreground="Black">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/message_bubble_view_icon.png" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem  Header="_Clear message cache"  Click="Clear_MessageCache" Foreground="Black">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/bin_menu_choice.ico" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                    </MenuItem>
                    <MenuItem Header="Sort" Width="77" Background="#FFA4A1A1">
                        <MenuItem  Header="_Timestamp (Default)" Foreground="Black">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/timestamp_menu_choice.ico" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                            <MenuItem Name="Timestamp_ascending_menu" Header="Ascending order" Foreground="Black" Click="SortingAscendingMenu_Click" Tag="Timestamp">
                                <MenuItem.Icon>
                                    <Image Source="../Resources/Icons/ascending_up.ico" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                                </MenuItem.Icon>
                            </MenuItem>
                            <Separator/>
                            <MenuItem Name="Timestamp_descending_menu" Header="Descending order" Foreground="Black" Click="SortingDescendingMenu_Click" Tag="Timestamp">
                                <MenuItem.Icon>
                                    <Image Source="../Resources/Icons/descending.ico" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                                </MenuItem.Icon>
                            </MenuItem>
                        </MenuItem>
                        <Separator/>
                        <MenuItem  Header="_Username" Foreground="Black">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/username_menu_choice.ico" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                            <MenuItem Name="username_ascending_menu" Header="Ascending order" Foreground="Black" Click="SortingAscendingMenu_Click" Tag="Username">
                                <MenuItem.Icon>
                                    <Image Source="../Resources/Icons/ascending_up.ico" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                                </MenuItem.Icon>
                            </MenuItem>
                            <Separator/>
                            <MenuItem Name="username_descending_menu" Header="Descending order" Foreground="Black" Click="SortingDescendingMenu_Click" Tag="Username">
                                <MenuItem.Icon>
                                    <Image Source="../Resources/Icons/descending.ico" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                                </MenuItem.Icon>
                            </MenuItem>
                        </MenuItem>
                        <Separator/>
                        <MenuItem  Header="_All Criteria" Foreground="Black">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/criteria_menu_choice.ico" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                            <MenuItem Name="allCriteria_ascending_menu" Header="Ascending order" Foreground="Black" Click="SortingAscendingMenu_Click" Tag="All Criteria">
                                <MenuItem.Icon>
                                    <Image Source="../Resources/Icons/ascending_up.ico" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                                </MenuItem.Icon>
                            </MenuItem>
                            <Separator/>
                            <MenuItem Name="allCriteria_descending_menu" Header="Descending order" Foreground="Black" Click="SortingDescendingMenu_Click" Tag="All Criteria">
                                <MenuItem.Icon>
                                    <Image Source="../Resources/Icons/descending.ico" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                                </MenuItem.Icon>
                            </MenuItem>
                        </MenuItem>
                        <Separator/>
                        <MenuItem Header="_Reset message sort" Foreground="Black" Click="ResetMessageSort">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/reset.png" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                    </MenuItem>
                    <MenuItem Header="Filter" Width="77" Background="#FFA4A1A1">
                        <MenuItem Header="_Filter" Foreground="Black" Click="Filter_Button_Click">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/filter_menu_choice.png" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem Header="_Clear filter options" Foreground="Black" Click="Clear_Filtering">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/clear_filter_menu_choice.png" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem Header="_Reset message filtering" Foreground="Black" Click="Filter_Reset_Button">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/reset.png" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                    </MenuItem>
                </Menu>
                <Grid Name ="UserDetailsGrid" Grid.Column="1" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,0,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Label Name="Logged_Label" Content="Logged as:" Grid.Column="0" HorizontalAlignment="Right" Height="18" VerticalAlignment="Top" FontWeight="Medium" Foreground="#FF86DAB0" FontSize="12" VerticalContentAlignment="Top" HorizontalContentAlignment="Right" Padding="0" Margin="0,0,2,0" FontFamily="Tahoma"/>
                    <Label Name="User_Name_Label" Content="{Binding Source={x:Static logic:ChatRoom._loggedInUser}, Path=username, Mode=OneWay}" Grid.Column="1" HorizontalAlignment="Left" Height="18" VerticalAlignment="Top"  Foreground="White" FontWeight="ExtraLight" FontSize="11" VerticalContentAlignment="Top" HorizontalContentAlignment="Left" Padding="0" Margin="2,0,6,0" FontFamily="Tahoma"/>
                    <Label Name="Group_Label" Content="Group ID:" Grid.Column="2" HorizontalAlignment="Right" Height="18" VerticalAlignment="Top" FontWeight="Medium" Foreground="#FFAFD1F3" FontSize="12" VerticalContentAlignment="Top" HorizontalContentAlignment="Left" Padding="0" Margin="6,0,2,0" FontFamily="Tahoma"/>
                    <Label Name="User_Group_Label" Content="{Binding Source={x:Static logic:ChatRoom._loggedInUser}, Path=groupID, Mode=OneWay}" Grid.Column="3" HorizontalAlignment="Left" Height="18" VerticalAlignment="Top" Foreground="White" FontWeight="ExtraLight" FontSize="11" VerticalContentAlignment="Top" HorizontalContentAlignment="Left" Padding="0" Margin="2,0,10,0" FontFamily="Tahoma"/>
                </Grid>
            </Grid>
        </DockPanel>


        <Grid Name="MainDisplayGrid" Grid.Row="1" Margin="0,0,-2,-1" >
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="180"/>
            </Grid.ColumnDefinitions>
            <!--Chat Box Area-->
            <Grid Name="ChatAreaGrid" Grid.Column="0" Margin="0,0,-2,-1" >
                <Grid.RowDefinitions>
                    <RowDefinition Height="90"/>
                    <RowDefinition Height="30"/>
                    <RowDefinition/>
                    <RowDefinition Height="101"/>
                </Grid.RowDefinitions>

                <!-- Notification Box Area-->
                <Grid Name="NotificationAreaGrid" Grid.Row="0" HorizontalAlignment="Left" Height="71" Margin="10,19,0,0" VerticalAlignment="Top">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="125"/>
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Image Grid.Column="0" HorizontalAlignment="Left" Height="18" Margin="10,25,0,0" VerticalAlignment="Top" Width="18" Source="pack://siteoforigin:,,,/Resources/Icons/notifications.png" RenderOptions.BitmapScalingMode="HighQuality"/>
                    <Label Content="Notifications:" Grid.Column="0" HorizontalAlignment="Left" Height="33" Margin="30,19,0,0" VerticalAlignment="Top" Width="100" Foreground="Black" FontSize="14" FontWeight="Medium" FontStretch="SemiCondensed"/>
                    <RichTextBox Name="NotificationsBox" Grid.Column="1" GotFocus="Clear_Notifications" FocusManager.FocusedElement="{Binding RelativeSource={RelativeSource Self}}"  HorizontalAlignment="Stretch" Height="61" VerticalAlignment="Top" Margin="0,5,20,0" Background="White" BorderBrush="#FF828282" SelectionBrush="#FF5E8960" IsReadOnly="True" TextChanged="NotificationsBox_TextChanged" FontSize="14">
                        <RichTextBox.Resources>
                            <Style TargetType="{x:Type Paragraph}">
                                <Setter Property="Margin" Value="0.5"/>
                            </Style>
                        </RichTextBox.Resources>
                        <FlowDocument>
                            <Paragraph/>
                        </FlowDocument>
                    </RichTextBox>
                </Grid>

                <Grid Name="ChatBoxDetailsAreaGrid" VerticalAlignment="Center" Height="30" Margin="10,0,22,0" Grid.Row="1" HorizontalAlignment="Stretch">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="215*" />
                        <ColumnDefinition Width="111*" />
                        <ColumnDefinition Width="208*"/>
                        <ColumnDefinition Width="209*"/>
                    </Grid.ColumnDefinitions>


                    <Label Name="MessageCount" Grid.Column="0" GotFocus="MessageCounter" FocusManager.FocusedElement="{Binding RelativeSource={RelativeSource Self}}" HorizontalAlignment="Left" Height="28" VerticalAlignment="Top" Width="196" Foreground="White" FontSize="14" Margin="0,2,0,0"/>
                    <Grid Grid.Column="1" HorizontalAlignment="Left" VerticalAlignment="Bottom" Width="110" Height="30">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="12" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Image Name="filter_indicator_image" Grid.Column="0" HorizontalAlignment="Right" Visibility="{Binding Path=hasFilters, Mode=OneWay, Converter={StaticResource InvertableBoolToVisibilityConverter}, ConverterParameter=Normal}" Height="11" Margin="0,14,0,0" VerticalAlignment="Top" Width="12" Source="../Resources/Icons/filter.ico" RenderOptions.BitmapScalingMode="HighQuality"/>
                        <Label Name="Filter_indicator" Grid.Column="1" Visibility="{Binding Path=hasFilters, Mode=OneWay, Converter={StaticResource InvertableBoolToVisibilityConverter}, ConverterParameter=Normal}" Content="Messages Filtered" HorizontalAlignment="Left" HorizontalContentAlignment="Left" Height="24" Margin="0,6,0,0" VerticalAlignment="Top" Width="104" Background="#00000000" Foreground="#FF1A65B4" FontWeight="SemiBold" FontSize="11"/>
                    </Grid>
                    <Grid Grid.Column="2" HorizontalAlignment="Right" VerticalAlignment="Bottom" Width="185" Height="30">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="62" />
                            <ColumnDefinition Width="20" />
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Name="Sort_label" Grid.Column="0" Visibility="Visible" Content="Sorted by: " HorizontalAlignment="Left" HorizontalContentAlignment="Left" Height="24" Margin="0,6,0,0" VerticalAlignment="Top" Width="62" Background="#00000000" Foreground="#FF1A65B4" FontWeight="SemiBold" FontSize="11"/>
                        <Label Name="Sort_indicator" Grid.Column="2" Content="{Binding Path=sortMethod, Mode = TwoWay}" Visibility="Visible" HorizontalAlignment="Right" HorizontalContentAlignment="Left" Height="24" Margin="0,6,0,0" VerticalAlignment="Top" Width="103" Background="#00000000" Foreground="#FF3D4B5B" FontWeight="SemiBold" RenderTransformOrigin="0.841,0.357" FontSize="11"/>
                        <Button Name="ascending_indicator_button" Grid.Column="1" Visibility="{Binding Path=ascendingOrder, Mode=TwoWay, Converter={StaticResource InvertableBoolToVisibilityConverter}, ConverterParameter=Normal}" ToolTip="Change sorting direction" HorizontalAlignment="Left" Height="20" Margin="0,9,0,0" VerticalAlignment="Top" Width="20" BorderBrush="{x:Null}" Click="Ascending_Descending_Indicator_Click" RenderTransformOrigin="0.65,0.045">
                            <Button.Background>
                                <ImageBrush ImageSource="../Resources/Icons/ascending_indicator.png" Stretch="Uniform" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </Button.Background>
                        </Button>
                        <Button Name="descending_indicator_button" Grid.Column="1" Visibility="{Binding Path=ascendingOrder, Mode=TwoWay, Converter={StaticResource InvertableBoolToVisibilityConverter}, ConverterParameter=Inverted}" ToolTip="Change sorting direction" HorizontalAlignment="Left" Height="20" Margin="0,9,0,0" VerticalAlignment="Top" Width="20" BorderBrush="{x:Null}" Click="Ascending_Descending_Indicator_Click">
                            <Button.Background>
                                <ImageBrush ImageSource="../Resources/Icons/decsending_indicator.png" Stretch="Uniform" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </Button.Background>
                        </Button>
                    </Grid>
                    <Label Name="RegisteredUsers" Grid.Column="3" GotFocus="MessageCounter" HorizontalAlignment="Right" HorizontalContentAlignment="Right" Height="28" Margin="0,2,3,0" VerticalAlignment="Top" Width="204" Foreground="White" FontSize="14"/>

                </Grid>

                <Grid Name="ChatBoxGrid" Grid.Row="2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="10,6,0,0" >
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="25" />
                    </Grid.ColumnDefinitions>
                    <controls:BindableRichTextBox x:Name="ChatMessages_Block" Document="{Binding Path=shownMessagesDocument}" Grid.Column="0" ScrollViewer.VerticalScrollBarVisibility="Visible" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="White" Foreground="Black" IsReadOnly="True" BorderBrush="#FF828282" FontFamily="Leelawadee UI" SelectionBrush="#FF5E8960" UseLayoutRounding="True" ScrollViewer.CanContentScroll="True" Loaded="ChatMessages_Block_Loaded" Margin="0,0,0,2">
                        <RichTextBox.Resources>
                            <Style x:Key="ScrollThumb" TargetType="{x:Type Thumb}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type Thumb}">
                                            <Rectangle x:Name="Rectangle1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Fill="Transparent" SnapsToDevicePixels="True"/>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="Tag" Value="Horizontal">
                                                    <Setter TargetName="Rectangle1" Property="Width" Value="Auto" />
                                                    <Setter TargetName="Rectangle1" Property="Height" Value="7" />
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                            <Style x:Key="{x:Type ScrollBar}" TargetType="{x:Type ScrollBar}">
                                <Setter Property="Stylus.IsFlicksEnabled" Value="false" />
                                <Setter Property="Foreground" Value="#FF93C0EF" />
                                <Setter Property="Background" Value="#FFD9D9D9" />
                                <Setter Property="Width" Value="10" />
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type ScrollBar}">
                                            <Grid x:Name="GridRoot" Width="19" Background="{TemplateBinding Background}">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="0.00001*" />
                                                </Grid.RowDefinitions>

                                                <Track x:Name="PART_Track" Grid.Row="0" IsDirectionReversed="true" Focusable="false">
                                                    <Track.Thumb>
                                                        <Thumb x:Name="Thumb" Background="{TemplateBinding Foreground}" Style="{DynamicResource ScrollThumbs}" />
                                                    </Track.Thumb>
                                                    <Track.IncreaseRepeatButton>
                                                        <RepeatButton x:Name="PageUp" Command="ScrollBar.PageDownCommand" Opacity="0" Focusable="false" />
                                                    </Track.IncreaseRepeatButton>
                                                    <Track.DecreaseRepeatButton>
                                                        <RepeatButton x:Name="PageDown" Command="ScrollBar.PageUpCommand" Opacity="0" Focusable="false" />
                                                    </Track.DecreaseRepeatButton>
                                                </Track>
                                            </Grid>

                                            <ControlTemplate.Triggers>
                                                <Trigger SourceName="Thumb" Property="IsMouseOver" Value="true">
                                                    <Setter Value="{DynamicResource ButtonSelectBrush}" TargetName="Thumb" Property="Background" />
                                                </Trigger>
                                                <Trigger SourceName="Thumb" Property="IsDragging" Value="true">
                                                    <Setter Value="{DynamicResource DarkBrush}" TargetName="Thumb" Property="Background" />
                                                </Trigger>

                                                <Trigger Property="IsEnabled" Value="false">
                                                    <Setter TargetName="Thumb" Property="Visibility" Value="Collapsed" />
                                                </Trigger>
                                                <Trigger Property="Orientation" Value="Horizontal">
                                                    <Setter TargetName="GridRoot" Property="LayoutTransform">
                                                        <Setter.Value>
                                                            <RotateTransform Angle="-90" />
                                                        </Setter.Value>
                                                    </Setter>
                                                    <Setter TargetName="PART_Track" Property="LayoutTransform">
                                                        <Setter.Value>
                                                            <RotateTransform Angle="-90" />
                                                        </Setter.Value>
                                                    </Setter>
                                                    <Setter Property="Width" Value="Auto" />
                                                    <Setter Property="Height" Value="12" />
                                                    <Setter TargetName="Thumb" Property="Tag" Value="Horizontal" />
                                                    <Setter TargetName="PageDown" Property="Command" Value="ScrollBar.PageLeftCommand" />
                                                    <Setter TargetName="PageUp" Property="Command" Value="ScrollBar.PageRightCommand" />
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                            <Style TargetType="{x:Type Paragraph}">
                                <Setter Property="Margin" Value="0"/>
                            </Style>
                        </RichTextBox.Resources>
                    </controls:BindableRichTextBox>
                    <Button x:Name="scroll_top" Grid.Column="1" Margin="1,0,3,0" VerticalAlignment="Top" Click="Scroll_Top" BorderBrush="{x:Null}" RenderTransformOrigin="0.508,0.51" Height="25" >
                        <Button.Background>
                            <ImageBrush ImageSource="../Resources/Images/scroll_up.png" Stretch="UniformToFill" RenderOptions.BitmapScalingMode="HighQuality"/>
                        </Button.Background>
                    </Button>
                    <Button x:Name="scroll_down" Grid.Column="1" Margin="1,0,3,0" VerticalAlignment="Bottom" Click="Scroll_Down" BorderBrush="{x:Null}" RenderTransformOrigin="0.508,0.51" Height="25">
                        <Button.Background>
                            <ImageBrush ImageSource="../Resources/Images/scroll_down.png" Stretch="UniformToFill" RenderOptions.BitmapScalingMode="HighQuality"/>
                        </Button.Background>
                    </Button>
                </Grid>
                <!--User Message Input Area-->
                <Grid Name="UserMessageAreaGrid" Grid.Row="3" HorizontalAlignment="Stretch" VerticalAlignment="Top" Height="100" Margin="10,0,22,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="73" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="25" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <!--Emoticon Button Menu-->
                    <Button Name="Emoticon_Button" Content="🙂" Tag="Open" Grid.Column="0" Grid.Row="0" FontSize="16" ToolTip="Add Emoticon" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Width="28" Height="25" Click="Open_Emoticon_Context_Menu" ContextMenuService.IsEnabled="False" Margin="2,0,0,0" VerticalAlignment="Center" HorizontalAlignment="Left" FontWeight="SemiBold">
                        <Button.Background>
                            <RadialGradientBrush>
                                <GradientStop Color="#FFC4DCF5" Offset="1"/>
                                <GradientStop Color="White"/>
                            </RadialGradientBrush>
                        </Button.Background>
                        <Button.ContextMenu>
                            <ContextMenu HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0,0,0,0" Placement="Top">
                                <ContextMenu.Style>
                                    <Style TargetType="{x:Type ContextMenu}">
                                        <Setter Property="ItemsPanel" Value="{StaticResource NoSideIconMenu}"/>
                                    </Style>
                                </ContextMenu.Style>
                                <Grid Height="322" Width="318" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Margin="0,0,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="18"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="22"/>
                                    </Grid.RowDefinitions>
                                    <Button Content="😀" Tag="😀" Grid.Column="0" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="😂" Tag="😂" Grid.Column="1" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="😃" Tag="😃" Grid.Column="2" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="😋" Tag="😋" Grid.Column="3" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="😅" Tag="😅" Grid.Column="4" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="😎" Tag="😎" Grid.Column="5" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="😍" Tag="😍" Grid.Column="6" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="😘" Tag="😘" Grid.Column="7" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="😗" Tag="😗" Grid.Column="8" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🤗" Tag="🤗" Grid.Column="0" Grid.Row="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🤩" Tag="🤩" Grid.Column="1" Grid.Row="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="😐" Tag="😐" Grid.Column="2" Grid.Row="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🙄" Tag="🙄" Grid.Column="3" Grid.Row="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="😣" Tag="😣" Grid.Column="4" Grid.Row="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="😮" Tag="😮" Grid.Column="5" Grid.Row="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🤐" Tag="🤐" Grid.Column="6" Grid.Row="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="😥" Tag="😥" Grid.Column="7" Grid.Row="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="😜" Tag="😜" Grid.Column="8" Grid.Row="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🤑" Tag="🤑" Grid.Column="0" Grid.Row="2" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="☹" Tag="☹" Grid.Column="1" Grid.Row="2" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="😭" Tag="😭" Grid.Column="2" Grid.Row="2" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="😡" Tag="😡" Grid.Column="3" Grid.Row="2" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="😈" Tag="😈" Grid.Column="4" Grid.Row="2" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="👽" Tag="👽" Grid.Column="5" Grid.Row="2" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="💩" Tag="💩" Grid.Column="6" Grid.Row="2" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="💀" Tag="💀" Grid.Column="7" Grid.Row="2" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🤡" Tag="🤡" Grid.Column="8" Grid.Row="2" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="💪" Tag="💪" Grid.Column="0" Grid.Row="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="☝" Tag="☝" Grid.Column="1" Grid.Row="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="✌" Tag="✌" Grid.Column="2" Grid.Row="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🖖" Tag="🖖" Grid.Column="3" Grid.Row="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🤘" Tag="🤘" Grid.Column="4" Grid.Row="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="✋" Tag="✋" Grid.Column="5" Grid.Row="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="👍" Tag="👍" Grid.Column="6" Grid.Row="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="👎" Tag="👎" Grid.Column="7" Grid.Row="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="👌" Tag="👌" Grid.Column="8" Grid.Row="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🤛" Tag="🤛" Grid.Column="0" Grid.Row="4" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🙌" Tag="🙌" Grid.Column="1" Grid.Row="4" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🙏" Tag="🙏" Grid.Column="2" Grid.Row="4" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="👄" Tag="👄" Grid.Column="3" Grid.Row="4" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="👅" Tag="👅" Grid.Column="4" Grid.Row="4" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="❤" Tag="❤" Grid.Column="5" Grid.Row="4" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="💋" Tag="💋" Grid.Column="6" Grid.Row="4" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🎓" Tag="🎓" Grid.Column="7" Grid.Row="4" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="💍" Tag="💍" Grid.Column="8" Grid.Row="4" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="💄" Tag="💄" Grid.Column="0" Grid.Row="5" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🐵" Tag="🐵" Grid.Column="1" Grid.Row="5" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🐯" Tag="🐯" Grid.Column="2" Grid.Row="5" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🦁" Tag="🦁" Grid.Column="3" Grid.Row="5" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🐷" Tag="🐷" Grid.Column="4" Grid.Row="5" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🌹" Tag="🌹" Grid.Column="5" Grid.Row="5" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🍉" Tag="🍉" Grid.Column="6" Grid.Row="5" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🍇" Tag="🍇" Grid.Column="7" Grid.Row="5" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🍌" Tag="🍌" Grid.Column="8" Grid.Row="5" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="⏰" Tag="⏰" Grid.Column="0" Grid.Row="6" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🌞" Tag="🌞" Grid.Column="1" Grid.Row="6" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="❄" Tag="❄" Grid.Column="2" Grid.Row="6" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🎈" Tag="🎈" Grid.Column="3" Grid.Row="6" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🎉" Tag="🎉" Grid.Column="4" Grid.Row="6" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🎁" Tag="🎁" Grid.Column="5" Grid.Row="6" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="⚽" Tag="⚽" Grid.Column="6" Grid.Row="6" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="📸" Tag="📸" Grid.Column="7" Grid.Row="6" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="✉" Tag="✉" Grid.Column="8" Grid.Row="6" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🔑" Tag="🔑" Grid.Column="0" Grid.Row="7" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="💾" Tag="💾" Grid.Column="1" Grid.Row="7" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="📞" Tag="📞" Grid.Column="2" Grid.Row="7" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🎸" Tag="🎸" Grid.Column="3" Grid.Row="7" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🎧" Tag="🎧" Grid.Column="4" Grid.Row="7" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="♠" Tag="♠" Grid.Column="5" Grid.Row="7" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="♥" Tag="♥" Grid.Column="6" Grid.Row="7" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="♦" Tag="♦" Grid.Column="7" Grid.Row="7" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="♣" Tag="♣" Grid.Column="8" Grid.Row="7" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🏀" Tag="🏀" Grid.Column="0" Grid.Row="8" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🔥" Tag="🔥" Grid.Column="1" Grid.Row="8" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="⚡" Tag="⚡" Grid.Column="2" Grid.Row="8" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="☂" Tag="☂" Grid.Column="3" Grid.Row="8" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="⭐" Tag="⭐" Grid.Column="4" Grid.Row="8" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🌍" Tag="🌍" Grid.Column="5" Grid.Row="8" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🔪" Tag="🔪" Grid.Column="6" Grid.Row="8" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="🍺" Tag="🍺" Grid.Column="7" Grid.Row="8" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Content="👻" Tag="👻" Grid.Column="8" Grid.Row="8" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                    <Button Name="Additional_Emoticons_Button" Content="▶" Tag="More" Grid.Column="9" Grid.RowSpan="9" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="#FFD8D8D8" BorderBrush="#FFC3C3C3" FontSize="12" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Open_Emoticon_Context_Menu">
                                        <Button.ContextMenu>
                                            <ContextMenu HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0,0,0,0" Placement="Left">
                                                <ContextMenu.Style>
                                                    <Style TargetType="{x:Type ContextMenu}">
                                                        <Setter Property="ItemsPanel" Value="{StaticResource NoSideIconMenu}"/>
                                                    </Style>
                                                </ContextMenu.Style>
                                                <Grid Height="300" Width="318" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Margin="0,0,0,0">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="18"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="*"/>
                                                        <RowDefinition Height="*"/>
                                                        <RowDefinition Height="*"/>
                                                        <RowDefinition Height="*"/>
                                                        <RowDefinition Height="*"/>
                                                        <RowDefinition Height="*"/>
                                                        <RowDefinition Height="*"/>
                                                        <RowDefinition Height="*"/>
                                                        <RowDefinition Height="*"/>
                                                    </Grid.RowDefinitions>
                                                    <Button Content="🌛" Tag="🌛" Grid.Column="1" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🌴" Tag="🌴" Grid.Column="2" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🍩" Tag="🍩" Grid.Column="3" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🍭" Tag="🍭" Grid.Column="4" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🍴" Tag="🍴" Grid.Column="5" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🍦" Tag="🍦" Grid.Column="6" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🍣" Tag="🍣" Grid.Column="7" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="👑" Tag="👑" Grid.Column="8" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🎵" Tag="🎵" Grid.Column="9" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🎲" Tag="🎲" Grid.Column="1" Grid.Row="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🎬" Tag="🎬" Grid.Column="2" Grid.Row="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🐟" Tag="🐟" Grid.Column="3" Grid.Row="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🐴" Tag="🐴" Grid.Column="4" Grid.Row="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🐶" Tag="🐶" Grid.Column="5" Grid.Row="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🐾" Tag="🐾" Grid.Column="6" Grid.Row="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="👃" Tag="👃" Grid.Column="7" Grid.Row="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="👂" Tag="👂" Grid.Column="8" Grid.Row="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="👀" Tag="👀" Grid.Column="9" Grid.Row="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="👏" Tag="👏" Grid.Column="1" Grid.Row="2" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="👩" Tag="👩" Grid.Column="2" Grid.Row="2" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="👦" Tag="👦" Grid.Column="3" Grid.Row="2" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="👳" Tag="👳" Grid.Column="4" Grid.Row="2" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="👺" Tag="👺" Grid.Column="5" Grid.Row="2" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="👾" Tag="👾" Grid.Column="6" Grid.Row="2" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="💎" Tag="💎" Grid.Column="7" Grid.Row="2" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="💔" Tag="💔" Grid.Column="8" Grid.Row="2" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="💣" Tag="💣" Grid.Column="9" Grid.Row="2" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="💥" Tag="💥" Grid.Column="1" Grid.Row="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="💨" Tag="💨" Grid.Column="2" Grid.Row="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="💯" Tag="💯" Grid.Column="3" Grid.Row="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="💬" Tag="💬" Grid.Column="4" Grid.Row="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="💲" Tag="💲" Grid.Column="5" Grid.Row="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="💿" Tag="💿" Grid.Column="6" Grid.Row="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="📆" Tag="📆" Grid.Column="7" Grid.Row="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="📞" Tag="📞" Grid.Column="8" Grid.Row="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="📢" Tag="📢" Grid.Column="9" Grid.Row="3" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🔫" Tag="🔫" Grid.Column="1" Grid.Row="4" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🕜" Tag="🕜" Grid.Column="2" Grid.Row="4" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="✔" Tag="✔" Grid.Column="3" Grid.Row="4" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="✖" Tag="✖" Grid.Column="4" Grid.Row="4" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="✈" Tag="✈" Grid.Column="5" Grid.Row="4" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="✂" Tag="✂" Grid.Column="6" Grid.Row="4" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="❔" Tag="❔" Grid.Column="7" Grid.Row="4" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="❕" Tag="❕" Grid.Column="8" Grid.Row="4" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="➕" Tag="➕" Grid.Column="9" Grid.Row="4" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="➗" Tag="➗" Grid.Column="1" Grid.Row="5" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="➖" Tag="➖" Grid.Column="2" Grid.Row="5" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🚕" Tag="🚕" Grid.Column="3" Grid.Row="5" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🚚" Tag="🚚" Grid.Column="4" Grid.Row="5" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🚢" Tag="🚢" Grid.Column="5" Grid.Row="5" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🚀" Tag="🚀" Grid.Column="6" Grid.Row="5" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="©" Tag="©" Grid.Column="7" Grid.Row="5" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="®" Tag="®" Grid.Column="8" Grid.Row="5" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="↔" Tag="↔" Grid.Column="9" Grid.Row="5" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="↕" Tag="↕" Grid.Column="1" Grid.Row="6" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="⏩" Tag="⏩" Grid.Column="2" Grid.Row="6" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="▶" Tag="▶" Grid.Column="3" Grid.Row="6" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="◀" Tag="◀" Grid.Column="4" Grid.Row="6" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="◼" Tag="◼" Grid.Column="5" Grid.Row="6" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="☎" Tag="☎" Grid.Column="6" Grid.Row="6" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="☀" Tag="☀" Grid.Column="7" Grid.Row="6" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="☑" Tag="☑" Grid.Column="8" Grid.Row="6" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="♈" Tag="♈" Grid.Column="9" Grid.Row="6" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="♉" Tag="♉" Grid.Column="1" Grid.Row="7" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="♊" Tag="♊" Grid.Column="2" Grid.Row="7" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="♋" Tag="♋" Grid.Column="3" Grid.Row="7" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="♌" Tag="♌" Grid.Column="4" Grid.Row="7" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="♍" Tag="♍" Grid.Column="5" Grid.Row="7" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="♎" Tag="♎" Grid.Column="6" Grid.Row="7" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="♏" Tag="♏" Grid.Column="7" Grid.Row="7" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="♐" Tag="♐" Grid.Column="8" Grid.Row="7" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="♑" Tag="♑" Grid.Column="9" Grid.Row="7" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="♒" Tag="♒" Grid.Column="1" Grid.Row="8" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="♓" Tag="♓" Grid.Column="2" Grid.Row="8" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="⚓" Tag="⚓" Grid.Column="3" Grid.Row="8" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🌈" Tag="🌈" Grid.Column="4" Grid.Row="8" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🌸" Tag="🌸" Grid.Column="5" Grid.Row="8" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🍀" Tag="🍀" Grid.Column="6" Grid.Row="8" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="🍄" Tag="🍄" Grid.Column="7" Grid.Row="8" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="👓" Tag="👓" Grid.Column="8" Grid.Row="8" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Content="👶" Tag="👶" Grid.Column="9" Grid.Row="8" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="White" BorderBrush="#FFEAEAEA" FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                    <Button Name="Close_Additional_Emoticons" Content="◀" Tag="CloseExtra" Grid.Column="0" Grid.RowSpan="9" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="#FFD8D8D8" BorderBrush="#FFC3C3C3" FontSize="12" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message"/>
                                                </Grid>
                                            </ContextMenu>
                                        </Button.ContextMenu>
                                    </Button>
                                    <Button Content="_Close" Tag="Close" Grid.Row="9" Grid.ColumnSpan="10" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Background="#FFA6A6A6" BorderBrush="#FF7C7C7C" FontSize="14"  VerticalContentAlignment="Top" HorizontalContentAlignment="Center" Click="Add_Emoticon_User_Message" FontWeight="SemiBold"/>
                                </Grid>
                            </ContextMenu>
                        </Button.ContextMenu>
                    </Button>
                    <TextBox Name="UserMessageTextBox" Grid.Column="0" Grid.Row="1" Text="{Binding Path=currentUserMessageText, UpdateSourceTrigger=PropertyChanged}" Tag="Enter your message..." HorizontalAlignment="Stretch" Height="63" Margin="0,1,0,-3" TextWrapping="Wrap" VerticalAlignment="Top" Background="White" Foreground="#FFD0D0D0" SpellCheck.IsEnabled="True" AcceptsReturn="False" MaxLength="150" BorderBrush="#FF828282" FontSize="14" FontFamily="Leelawadee UI" SelectionBrush="#FF5E8960" TextChanged="UserMessageTextBox_NotifyMaximumLength" GotFocus="UserMessageBox_Focus" LostFocus="UserMessageBox_Unfocus"/>
                    <Button Name="SendMessageUserButton" Grid.Row="1" HorizontalAlignment="Center" Height="57" Margin="0,2,0,0" VerticalAlignment="Top" Width="57" ToolTip="Press button or Enter to send your message." Click="SendMessage_Button" BorderBrush="{x:Null}" Grid.Column="1">
                        <Button.Background>
                            <ImageBrush ImageSource="pack://siteoforigin:,,,/Resources/Icons/send_message.png" Stretch="Uniform" RenderOptions.BitmapScalingMode="HighQuality"/>
                        </Button.Background>
                    </Button>
                    <Button Name="Backspace_Button" Grid.Column="0" Grid.Row="0" HorizontalAlignment="Right" Height="18" Margin="642,-1,0,0" VerticalAlignment="Bottom" Width="24" BorderBrush="{x:Null}" Click="UserMessageBox_Clear" ToolTip="Clear entire user message">
                        <Button.Background>
                            <ImageBrush ImageSource="pack://siteoforigin:,,,/Resources/Icons/backsapce_icon.png" Stretch="Uniform" RenderOptions.BitmapScalingMode="HighQuality"/>
                        </Button.Background>
                    </Button>
                </Grid>
            </Grid>

            <!--ChatControls Grid Area-->
            <!--Chat Controls Area Background fill-->
            <Rectangle Grid.Column="1" Stroke="#FFD8D8D8" Margin="0,0,0,-1">
                <Rectangle.Fill>
                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                        <GradientStop Color="Gray" Offset="0"/>
                        <GradientStop Color="#FFE2E2E2" Offset="1"/>
                    </LinearGradientBrush>
                </Rectangle.Fill>
            </Rectangle>
            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="110"/>
                    <RowDefinition Height="70"/>
                    <RowDefinition Height="36"/>
                    <RowDefinition Height="76"/>
                    <RowDefinition Height="134"/>
                    <RowDefinition Height="108"/>
                    <RowDefinition Height="85"/>
                    <!--Empty Grid for enlarging purposes-->
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="66"/>
                    <RowDefinition Height="65"/>
                </Grid.RowDefinitions>

                <!--Logo Image-->
                <Grid Grid.Row="0" Margin="2,0,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="70"/>
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Button Name="Maximize_Minimize_Button" Grid.Column="0" Visibility="{Binding Path=isWindowMaxed, Mode=TwoWay, Converter={StaticResource InvertableBoolToVisibilityConverter}, ConverterParameter=Normal}" HorizontalAlignment="Left" Height="20" Margin="7,6,0,0" VerticalAlignment="Top" Width="20" Click="Maximize_Minimize_Window" BorderBrush="{x:Null}" ToolTip="Maximize\Normal window">
                        <Button.Background>
                            <ImageBrush ImageSource="../Resources/Icons/resize_window.png" Stretch="Uniform" RenderOptions.BitmapScalingMode="HighQuality"/>
                        </Button.Background>
                    </Button>
                    <Image Grid.Column="1" HorizontalAlignment="Right" Height="87" Margin="0,15,10,0" VerticalAlignment="Top" Width="87" Source="../Resources/Images/chatroom_logo.png" RenderOptions.BitmapScalingMode="HighQuality"/>
                </Grid>

                <!-- Logout Exit Button Area-->
                <Grid Grid.Row="1" HorizontalAlignment="Center" Height="65" Margin="11,0" VerticalAlignment="Top" Width="158">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="79"/>
                        <ColumnDefinition Width="79"/>
                    </Grid.ColumnDefinitions>
                    <Label Content="Logout" Grid.Column="0" HorizontalAlignment="Center" Height="23" Margin="0,0,0,1" VerticalAlignment="Bottom" Width="43" FontSize="10" FontWeight="SemiBold" VerticalContentAlignment="Top"/>
                    <Button Content="Logout" HorizontalAlignment="Center" Height="41" Margin="0,0,0,0" VerticalAlignment="Center" Width="59" BorderBrush="{x:Null}" BorderThickness="2" Click="Logout_Message" RenderTransformOrigin="0.349,2.038" Grid.Column="0">
                        <Button.Foreground>
                            <ImageBrush/>
                        </Button.Foreground>
                        <Button.Background>
                            <ImageBrush ImageSource="pack://siteoforigin:,,,/Resources/Icons/logout_icon.png" Stretch="Uniform" RenderOptions.BitmapScalingMode="HighQuality"/>
                        </Button.Background>
                    </Button>
                    <Label Content="Exit" Grid.Column="1" HorizontalAlignment="Center" Height="21" Margin="0,0,0,1" VerticalAlignment="Bottom" Width="26" FontSize="10" FontWeight="SemiBold" VerticalContentAlignment="Top"/>
                    <Button Content="Exit" HorizontalAlignment="Center" Height="41" Margin="0,0,0,0" VerticalAlignment="Center" Width="59" BorderBrush="{x:Null}" BorderThickness="2" Click="Exit_Button" RenderTransformOrigin="0.349,2.038" Grid.Column="1">
                        <Button.Foreground>
                            <ImageBrush/>
                        </Button.Foreground>
                        <Button.Background>
                            <ImageBrush ImageSource="../Resources/Icons/shutdown.png" Stretch="Uniform" RenderOptions.BitmapScalingMode="HighQuality"/>
                        </Button.Background>
                    </Button>
                </Grid>
                <!--Message view mode-->
                <Image Source="../Resources/Icons/view_icon.png" Grid.Row="2" Margin="6,11,0,9" VerticalAlignment="Center" HorizontalAlignment="Left" Height="16" Width="15" RenderOptions.BitmapScalingMode="HighQuality"/>
                <Label Content="Change message view:" Grid.Row="2" Padding="0" HorizontalAlignment="Left" Height="28" Margin="26,4,0,4" VerticalAlignment="Center" Width="122" VerticalContentAlignment="Center" Foreground="White"/>
                <Button Name="Textual_View" Grid.Row="2" Visibility="{Binding chatBubbleView, ConverterParameter=Normal, Converter={StaticResource InvertableBoolToVisibilityConverter}, Mode=TwoWay}" HorizontalAlignment="Right" Height="18" Width="18" Margin="0,10,8,8" BorderBrush="{x:Null}" Click="Change_Message_View_Type" VerticalAlignment="Center" ToolTip="Change to textual view (Faster)." RenderTransformOrigin="0.525,0.763">
                    <Button.Background>
                        <ImageBrush Stretch="Uniform" ImageSource="../Resources/Icons/textual_view_icon.png" RenderOptions.BitmapScalingMode="HighQuality"/>
                    </Button.Background>
                </Button>
                <Button Name="Chat_Bubble_View" Grid.Row="2" Visibility="{Binding chatBubbleView, ConverterParameter=Inverted, Converter={StaticResource InvertableBoolToVisibilityConverter}, Mode=TwoWay}" HorizontalAlignment="Right" Height="22" Width="22" Margin="0,9,6,5" BorderBrush="{x:Null}" Click="Change_Message_View_Type" VerticalAlignment="Center" ToolTip="Change to chat bubble view (Slower)." RenderTransformOrigin="0.525,0.763">
                    <Button.Background>
                        <ImageBrush Stretch="Uniform" ImageSource="../Resources/Icons/message_bubble_view_icon.png" RenderOptions.BitmapScalingMode="HighQuality"/>
                    </Button.Background>
                </Button>
                <!--Text Size Slider-->
                <Rectangle Grid.Row="3" HorizontalAlignment="Left" Height="18" Margin="2,48,0,0" VerticalAlignment="Top" Width="176" StrokeThickness="0.5" Stroke="#FF8D8C8C">
                    <Rectangle.Fill>
                        <LinearGradientBrush EndPoint="0.5,1" MappingMode="RelativeToBoundingBox" StartPoint="0.5,0">
                            <GradientStop Color="#FF9E9E9C"/>
                            <GradientStop Color="#FFBFBEBE" Offset="1"/>
                        </LinearGradientBrush>
                    </Rectangle.Fill>
                </Rectangle>
                <Image Source="../Resources/Icons/text_size_icon.png" Grid.Row="3" Margin="10,5,0,0" VerticalAlignment="Top" HorizontalAlignment="Left" Height="18" Width="18" RenderOptions.BitmapScalingMode="HighQuality"/>
                <Label Content="Adjust messages text:" Grid.Row="3" HorizontalAlignment="Center" Height="28" Margin="28,0" VerticalAlignment="Top" Width="124" VerticalContentAlignment="Top" Foreground="White"/>
                <Slider Name="Text_Slider" Grid.Row="3" Value="{Binding Path=textSizeOffset, Mode=TwoWay}" Maximum="42" Minimum="-1" Height="14" Width="170" Margin="8,30,2,0" VerticalAlignment="Top" HorizontalAlignment="Center"/>
                <Label Name="Text_Size_Label" Content="Font Size:" Grid.Row="3" HorizontalAlignment="Center" Height="26" Margin="10,44,112,0" VerticalAlignment="Top" Width="58" VerticalContentAlignment="Top" HorizontalContentAlignment="Right" Foreground="Black" FontWeight="SemiBold" FontSize="11" Background="{x:Null}" />
                <Label Name="Text_Size_Indicator" Content="{Binding Path=textSizeOffset, Mode=OneWay, Converter={StaticResource FontSizeOffsetToRealFontSizeConverter}}" Grid.Row="3" HorizontalAlignment="Center" Height="26" Margin="60,44,94,0" VerticalAlignment="Top" Width="26" VerticalContentAlignment="Top" HorizontalContentAlignment="Left" Foreground="Black" FontSize="11" />
                <Button Name="Upscale_Text_Button" Grid.Row="3" Tag="+" HorizontalAlignment="Left" Height="18" Width="18" Margin="157,48,0,0" BorderBrush="{x:Null}" Click="Change_Font_Size" VerticalAlignment="Top" ToolTip="Increase font size" RenderTransformOrigin="0.525,0.763">
                    <Button.Background>
                        <ImageBrush Stretch="Uniform" ImageSource="../Resources/Icons/plus_icon.png" RenderOptions.BitmapScalingMode="HighQuality"/>
                    </Button.Background>
                </Button>
                <Button Name="Downscale_Text_Button" Grid.Row="3" Tag="-" HorizontalAlignment="Left" Height="18" Width="18" Margin="133,48,0,0" BorderBrush="{x:Null}" Click="Change_Font_Size" VerticalAlignment="Top" ToolTip="Decrease font size" RenderTransformOrigin="0.525,0.763">
                    <Button.Background>
                        <ImageBrush Stretch="Uniform" ImageSource="../Resources/Icons/minus_icon.png" RenderOptions.BitmapScalingMode="HighQuality"/>
                    </Button.Background>
                </Button>
                <Button Name="Default_Font_Settings" Grid.Row="3" Tag="default" HorizontalAlignment="Left" Height="15" Width="15" Margin="110,49,0,0" BorderBrush="{x:Null}" Click="Change_Font_Size" VerticalAlignment="Top" ToolTip="Default font settings" RenderTransformOrigin="0.525,0.763">
                    <Button.Background>
                        <ImageBrush Stretch="Uniform" ImageSource="../Resources/Icons/default_settings_icon.png" RenderOptions.BitmapScalingMode="HighQuality"/>
                    </Button.Background>
                </Button>
                <!--Sort Messages Menu Area-->
                <Label Content="Sort messages by:" Grid.Row="4" HorizontalAlignment="Left" Height="27" Margin="16,5,0,0" VerticalAlignment="Top" Width="124" VerticalContentAlignment="Top" HorizontalContentAlignment="Left" Foreground="White"/>
                <Menu Grid.Row="4" HorizontalAlignment="Center" Height="75" Margin="17,32,17,0" VerticalAlignment="Top" Width="146" Foreground="#FFCBCBCB" Background="#FFA0A0A0">
                    <MenuItem Header="Timestamp (Default)"  Width="146" Background="#FFEBEAEA" Foreground="Black" Height="25" VerticalAlignment="Center" HorizontalAlignment="Center" ToolTip="Sort by message timestamp.">
                        <MenuItem.Icon>
                            <Image Source="../Resources/Icons/timestamp_menu_choice.ico" Margin="2,2,-2,3" VerticalAlignment="Center" Height="11" RenderOptions.BitmapScalingMode="HighQuality"/>
                        </MenuItem.Icon>
                        <MenuItem Name="Timestamp_ascending" Header="Ascending order" Foreground="Black" Click="SortingAscendingMenu_Click" Tag="Timestamp">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/ascending_up.ico" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem Name="Timestamp_descending" Header="Descending order" Foreground="Black" Click="SortingDescendingMenu_Click" Tag="Timestamp">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/descending.ico" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                    </MenuItem>
                    <MenuItem Header="Nickname" Width="146" Background="#FFE5E5E5" Foreground="Black" Height="25" VerticalAlignment="Center" HorizontalAlignment="Center" ToolTip="Sort by usernames lexicographically.">
                        <MenuItem.Icon>
                            <Image Source="../Resources/Icons/username_menu_choice.ico" Margin="2,2,-2,3" VerticalAlignment="Center" Height="11" RenderOptions.BitmapScalingMode="HighQuality"/>
                        </MenuItem.Icon>
                        <MenuItem Name="username_ascending" Header="Ascending order" Foreground="Black" Click="SortingAscendingMenu_Click" Tag="Username">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/ascending_up.ico" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem Name="username_descending" Header="Descending order" Foreground="Black" Click="SortingDescendingMenu_Click" Tag="Username">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/descending.ico" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                    </MenuItem>
                    <MenuItem Header="All Criteria" Width="146" Background="#FFE0E0E0" Foreground="Black" Height="25" VerticalAlignment="Center" HorizontalAlignment="Center" ToolTip="Sort by group ID, then by username, then by timestamp.">
                        <MenuItem.Icon>
                            <Image Source="../Resources/Icons/criteria_menu_choice.ico" Margin="2,2,-2,3" VerticalAlignment="Center" Height="11" RenderOptions.BitmapScalingMode="HighQuality"/>
                        </MenuItem.Icon>
                        <MenuItem Name="allCriteria_ascending" Header="Ascending order" Foreground="Black" Click="SortingAscendingMenu_Click" Tag="All Criteria">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/ascending_up.ico" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem Name="allCriteria_descending" Header="Descending order" Foreground="Black" Click="SortingDescendingMenu_Click" Tag="All Criteria">
                            <MenuItem.Icon>
                                <Image Source="../Resources/Icons/descending.ico" Margin="0,2,-2,-1" RenderOptions.BitmapScalingMode="HighQuality"/>
                            </MenuItem.Icon>
                        </MenuItem>
                    </MenuItem>
                </Menu>
                <Label Name="Default_Sort_Label" Content="Currently Default" Grid.Row="4" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="20,27,0,0" Padding="0" FontWeight="SemiBold" FontSize="10" Height="0" Width="78" />
                <Button Name="Sorting_Reset_Button" Grid.Row="4" Content="Reset" HorizontalAlignment="Right" Height="18" Margin="0,112,18,0" VerticalAlignment="Top" Width="38" FontSize="10" Background="#FF252525" Foreground="White" RenderTransformOrigin="2.566,-1.361" Click="ResetMessageSort" ToolTip="Reset sorting options"/>
                <!--Filter Messages Options Area-->
                <Label  Content="Filter messages by:" Grid.Row="5" HorizontalAlignment="Left" Height="27" Margin="16,10,0,0" VerticalAlignment="Top" Width="124" VerticalContentAlignment="Top" HorizontalContentAlignment="Left" Foreground="White"/>
                <Button Name="Clear_Filters_Button" Grid.Row="5" HorizontalAlignment="Right" Height="14" Margin="0,23,22,0" VerticalAlignment="Top" Width="17" BorderBrush="{x:Null}" RenderTransformOrigin="0.875,-7.519" ToolTip="Clear filtering options" Click="Clear_Filtering">
                    <Button.Background>
                        <ImageBrush ImageSource="../Resources/Icons/backsapce_icon.png" Stretch="Uniform" RenderOptions.BitmapScalingMode="HighQuality"/>
                    </Button.Background>
                </Button>
                <TextBox Name="Filter_User_TextBox" Grid.Row="5" HorizontalAlignment="Center" Height="20" Margin="54,61,22,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="104" MaxLength="15" Background="#FF838383" KeyDown="Filter_Enter"/>
                <TextBox Name="Filter_GroupNumber_TextBox" Grid.Row="5" HorizontalAlignment="Center" Height="21" Margin="106,37,22,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="52" MaxLength="3" Background="#FF838383" KeyDown="Filter_Enter"/>
                <Label Content="Group number:" Grid.Row="5" HorizontalAlignment="Left" Height="26" Margin="18,33,0,0" VerticalAlignment="Top" Width="92" VerticalContentAlignment="Center" Foreground="White"/>
                <Image Name="Group_Filter_Icon" Grid.Row="5" HorizontalAlignment="Left" Height="14" Margin="5,40,0,0" VerticalAlignment="Top" Width="16" Source="../Resources/Icons/group_icon.png" RenderOptions.BitmapScalingMode="HighQuality"/>
                <Label Content="User:" Grid.Row="5" HorizontalAlignment="Left" Height="26" Margin="18,58,0,0" VerticalAlignment="Top" Width="72" VerticalContentAlignment="Center" Foreground="White"/>
                <Image Name="User_Filter_Icon" Grid.Row="5" HorizontalAlignment="Left" Height="16" Margin="5,65,0,0" VerticalAlignment="Top" Width="14" Source="../Resources/Icons/user_icon.png" RenderOptions.BitmapScalingMode="HighQuality"/>
                <Button Name="Filter_Button" Grid.Row="5" Content="&gt;" HorizontalAlignment="Right" Height="46" Margin="0,37,4,0" VerticalAlignment="Top" Width="16" Click="Filter_Button_Click" ToolTip="Filter"/>
                <Button Name="Filtering_Reset_Button" Grid.Row="5" Content="Reset" HorizontalAlignment="Right" Height="18" Margin="0,86,18,0" VerticalAlignment="Top" Width="38" FontSize="10" Foreground="White" Background="#FF2B2B2B" Click="Filter_Reset_Button" ToolTip="Reset filtering options"/>
                <!--Message Filtering Details Area-->
                <Label Content="No message filtering" Grid.Row="6" Visibility="{Binding Path=hasFilters, ConverterParameter=Inverted, Converter={StaticResource InvertableBoolToVisibilityConverter}, Mode=OneWay}" HorizontalAlignment="Center" Height="26" Margin="6,15,6,0" VerticalAlignment="Top" Width="168" FontWeight="Medium" FontStyle="Italic" Background="#FF979696" Foreground="#FF494949"/>
                <Label Content="Active message filtering:" Grid.Row="6" Visibility="{Binding Path=hasFilters, Mode=OneWay, Converter={StaticResource InvertableBoolToVisibilityConverter}, ConverterParameter=Normal}" HorizontalAlignment="Left" Height="26" Margin="6,15,0,0" VerticalAlignment="Top" Width="167" FontWeight="Medium" FontStyle="Italic" Background="#FF979696"/>
                <Label Content="Group Number:" Grid.Row="6" Visibility="{Binding Path=hasFilters, Mode=OneWay, Converter={StaticResource InvertableBoolToVisibilityConverter}, ConverterParameter=Normal}" HorizontalAlignment="Left" Height="25" Margin="5,40,0,0" VerticalAlignment="Top" Width="81" FontSize="10" FontWeight="Medium"/>
                <Label Content="{Binding filterByGroup, Mode=OneWay}" Grid.Row="6" Visibility="{Binding hasFilters, ConverterParameter=Normal, Converter={StaticResource InvertableBoolToVisibilityConverter}, Mode=OneWay}" HorizontalAlignment="Left" Height="24" Margin="80,41,0,0" VerticalAlignment="Top" Width="64" FontSize="9" FontWeight="Medium" HorizontalContentAlignment="Left"/>
                <Label Content="Username:" Grid.Row="6" Visibility="{Binding Path=hasFilters, Mode=OneWay, Converter={StaticResource InvertableBoolToVisibilityConverter}, ConverterParameter=Normal}" HorizontalAlignment="Left" Height="25" Margin="5,60,0,0" VerticalAlignment="Top" Width="59" FontSize="10" FontWeight="Medium"/>
                <Label Content="{Binding filterByName, Mode=OneWay}" Grid.Row="6" Visibility="{Binding hasFilters, ConverterParameter=Normal, Converter={StaticResource InvertableBoolToVisibilityConverter}, Mode=OneWay}" HorizontalAlignment="Left" Height="24" Margin="57,60,0,0" VerticalAlignment="Top" Width="101" FontSize="9" FontWeight="Medium" HorizontalContentAlignment="Left"/>
                <!--Sound And Server Status Info Area-->
                <Grid Grid.Row="8" HorizontalAlignment="Left" Height="60" Margin="5,0,0,0" Width="172" VerticalAlignment="Bottom">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="30*"/>
                        <RowDefinition Height="30*"/>
                    </Grid.RowDefinitions>
                    <Label Content="Sounds: " HorizontalAlignment="Left" Height="27" Margin="0,-2,0,0" VerticalAlignment="Bottom" Width="62" VerticalContentAlignment="Bottom" Foreground="Black" Grid.Row="0"/>
                    <Button Name="Sound_icon_on" Visibility="Visible" HorizontalAlignment="Left" Height="19" Margin="53,0,0,2" VerticalAlignment="Bottom" Width="20" BorderBrush="{x:Null}" Click="Sound_OnOff" Grid.Row="0" ToolTip="Disable sound">
                        <Button.Background>
                            <ImageBrush Stretch="Uniform" ImageSource="../Resources/Icons/sound_on.png" RenderOptions.BitmapScalingMode="HighQuality"/>
                        </Button.Background>
                    </Button>
                    <Button Name="Sound_icon_off" Visibility="Hidden" HorizontalAlignment="Left" Height="19" Margin="53,0,0,2" Width="20" BorderBrush="{x:Null}" Click="Sound_OnOff" VerticalAlignment="Bottom" ToolTip="Enable sound">
                        <Button.Background>
                            <ImageBrush Stretch="Uniform" ImageSource="../Resources/Icons/sound_off.png" RenderOptions.BitmapScalingMode="HighQuality"/>
                        </Button.Background>
                    </Button>
                    <Label Name="Connection_Status" Content="" HorizontalAlignment="Left" Height="27" Margin="82,0,0,0" VerticalAlignment="Top" Width="90" VerticalContentAlignment="Top" Foreground="Black" Grid.Row="1"/>
                    <Label Content="Server status:" HorizontalAlignment="Left" Height="27" VerticalAlignment="Top" Width="83" VerticalContentAlignment="Top" Foreground="Black" Grid.Row="1"/>
                    <Label Name="Sound_status_on_label" Visibility="Visible"  Content="On." HorizontalAlignment="Left" Height="26" Margin="82,0,0,28" VerticalAlignment="Bottom" Width="48" VerticalContentAlignment="Bottom" Foreground="#FF00B75B" Grid.RowSpan="2" FontWeight="SemiBold"/>
                    <Label Name="Sound_status_off_label" Content="Off." Visibility="Hidden" HorizontalAlignment="Left" Height="26" Margin="82,0,0,28" VerticalAlignment="Bottom" Width="48" VerticalContentAlignment="Bottom" Foreground="#880C25" Grid.RowSpan="2" FontWeight="SemiBold"/>
                </Grid>
                <!--Clear Messages And Server Refresh Area-->
                <Label Content="Clear message cache" Grid.Row="9" HorizontalAlignment="Right" Height="24" Margin="0,0,35,3" VerticalAlignment="Bottom" Width="94" FontSize="9"/>
                <Button Name="Clear_Messages_Button" Grid.Row="9" HorizontalAlignment="Right" Height="26" Margin="0,0,8,0" VerticalAlignment="Bottom" Width="30" Click="Clear_MessageCache" BorderBrush="{x:Null}" ToolTip="Delete entire message local history.">
                    <Button.Background>
                        <ImageBrush ImageSource="pack://siteoforigin:,,,/Resources/Icons/bin_messages_icon.png" Stretch="Uniform" RenderOptions.BitmapScalingMode="HighQuality"/>
                    </Button.Background>
                </Button>
                <Label Name="Refresh_Label" Grid.Row="9" Visibility="Hidden" Content="Refresh communication" HorizontalAlignment="Right" Height="24" Margin="0,0,35,33" VerticalAlignment="Bottom" Width="103" FontSize="9"/>
                <Button Name="Refresh_Button" Grid.Row="9" Visibility="Hidden" HorizontalAlignment="Right" Height="26" Margin="0,0,8,32" VerticalAlignment="Bottom" Width="30" Click="RefreshServerCommunication" BorderBrush="{x:Null}" ToolTip="Refresh your server connection">
                    <Button.Background>
                        <ImageBrush ImageSource="../Resources/Icons/refresh_communication_icon.png" Stretch="Uniform" RenderOptions.BitmapScalingMode="HighQuality"/>
                    </Button.Background>
                </Button>
            </Grid>
        </Grid>
    </Grid>
</Window>
